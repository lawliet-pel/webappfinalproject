<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Final Project Demo - 浮動視窗</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Noto Sans TC", Arial, sans-serif;
        background-color: #f7f4eb;
        color: #2f362f;
      }

      .app {
        display: flex;
        min-height: 100vh;
      }

      .sidebar {
        position: fixed;
        top: 20px;
        left: 20px;
        width: 280px;
        padding: 24px;
        border-radius: 24px;
        background: rgba(255, 255, 255, 0.92);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .sidebar h1 {
        margin: 0;
        font-size: 24px;
        letter-spacing: 2px;
        text-align: center;
      }

      .feature-list {
        display: grid;
        gap: 12px;
      }

      .feature-card {
        padding: 16px;
        border-radius: 16px;
        background: #d7f2ec;
        color: #1c5a4b;
        font-weight: bold;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        cursor: pointer;
        border: 2px solid transparent;
      }

      .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }

      .feature-card.active {
        background: #8bd2c5;
        border-color: #2b8371;
        color: #103d33;
      }

      .chat-box {
        margin-top: 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .chat-box label {
        font-weight: bold;
      }

      .chat-box textarea {
        width: 100%;
        min-height: 80px;
        resize: vertical;
        padding: 10px;
        border-radius: 12px;
        border: 1px solid #c2c2c2;
        font-family: inherit;
        font-size: 14px;
      }

      .chat-box button {
        align-self: flex-end;
        padding: 10px 18px;
        border-radius: 999px;
        border: none;
        background: linear-gradient(135deg, #ff9364, #f9698d);
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        transition: opacity 0.2s ease;
      }

      .chat-box button:hover {
        opacity: 0.85;
      }

      .content {
        margin-left: 340px;
        padding: 40px;
        flex: 1;
      }

      .content-card {
        max-width: 720px;
        padding: 28px;
        border-radius: 24px;
        background: #ffffff;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
      }

      .content-card h2 {
        margin-top: 0;
        font-size: 28px;
      }

      .message-preview {
        margin-top: 20px;
        padding: 16px;
        border-radius: 16px;
        background: #fff7e0;
        border: 1px dashed #e7b86d;
      }

       .ai-chat {
         margin-top: 28px;
         display: flex;
         flex-direction: column;
         gap: 16px;
       }

       .ai-messages {
         max-height: 320px;
         overflow-y: auto;
         padding: 20px;
         border-radius: 18px;
         background: #faf7f2;
         box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.04);
         display: flex;
         flex-direction: column;
         gap: 14px;
       }

       .ai-bubble {
         max-width: 75%;
         padding: 14px 16px;
         border-radius: 18px;
         line-height: 1.6;
         white-space: pre-wrap;
         word-break: break-word;
         box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
       }

       .ai-bubble.user {
         align-self: flex-end;
         background: linear-gradient(135deg, #71d2c0, #48b7ab);
         color: #08352e;
       }

       .ai-bubble.bot {
         align-self: flex-start;
         background: #ffffff;
         color: #2f362f;
       }

       .ai-input {
         display: flex;
         gap: 12px;
         align-items: center;
         padding: 14px;
         border-radius: 16px;
         background: #fff;
         box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
       }

       .ai-input textarea {
         flex: 1;
         border: none;
         resize: none;
         min-height: 60px;
         font-family: inherit;
         font-size: 15px;
         line-height: 1.6;
         background: transparent;
       }

       .ai-input textarea:focus {
         outline: none;
       }

       .ai-input button {
         padding: 12px 20px;
         border-radius: 12px;
         border: none;
         background: linear-gradient(135deg, #ff8b7d, #f965a7);
         color: #fff;
         font-weight: bold;
         cursor: pointer;
         transition: transform 0.2s ease, opacity 0.2s ease;
       }

       .ai-input button:hover {
         opacity: 0.9;
         transform: translateY(-1px);
       }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState } = React;

      const featureConfigs = [
        {
          id: "service",
          title: "服務介紹",
          description:
            "藉由AI輔助問診降低醫療人力的負擔，提升醫療效率。",
        },
        {
          id: "schedule",
          title: "預約",
          description:
            "提供預約服務，讓使用者可以快速預約服務。",
        },
        {
          id: "support",
          title: "AI問診",
          description:
            "提供AI問診服務，讓使用者可以快速問診。",
        },
      ];

      function App() {
        const [activeFeature, setActiveFeature] = useState(featureConfigs[0]);
        const [draftMessage, setDraftMessage] = useState("");
        const [lastMessage, setLastMessage] = useState("");
         const [conversation, setConversation] = useState([]);
         const [aiDraft, setAiDraft] = useState("");

        // 在左側浮動視窗內更新選擇狀態與輸入訊息
        const selectFeature = (feature) => {
          setActiveFeature(feature);
        };

        // 處理聊天輸入的提交並顯示於右側區塊
        const handleSend = () => {
          if (!draftMessage.trim()) {
            return;
          }
          setLastMessage(draftMessage.trim());
          setDraftMessage("");
        };

         // 處理 AI 問診右側對話框的訊息提交，預設回覆可替換為未來串接的 LLM 結果
         const handleAiSend = () => {
           if (!aiDraft.trim()) {
             return;
           }

           const input = aiDraft.trim();

           // 紀錄使用者輸入
           setConversation((prev) => [
             ...prev,
             { role: "user", content: input },
           ]);
           setAiDraft("");

           // 模擬 LLM 回應，後續可改為實際 API 呼叫
           setTimeout(() => {
             setConversation((prev) => [
               ...prev,
               {
                 role: "assistant",
                 content: `AI 預設回覆：感謝您的提問「${input}」，後端部署完成後會由真正的模型回覆。`,
               },
             ]);
           }, 600);
         };

        return (
          <div className="app">
            <aside className="sidebar">
              <h1>功能表</h1>
              <div className="feature-list">
                {featureConfigs.map((feature) => (
                  <div
                    key={feature.id}
                    className={`feature-card ${
                      activeFeature.id === feature.id ? "active" : ""
                    }`}
                    onClick={() => selectFeature(feature)}
                  >
                    {feature.title}
                  </div>
                ))}
              </div>

              <div className="chat-box">
                <label htmlFor="chat-input">快速訊息</label>
                <textarea
                  id="chat-input"
                  placeholder="輸入想詢問的內容..."
                  value={draftMessage}
                  onChange={(event) => setDraftMessage(event.target.value)}
                />
                <button type="button" onClick={handleSend}>
                  送出訊息
                </button>
              </div>
            </aside>

            <main className="content">
              <div className="content-card">
                <h2>{activeFeature.title}</h2>
                <p>{activeFeature.description}</p>

                 {activeFeature.id !== "support" && lastMessage && (
                  <div className="message-preview">
                    <strong>最新留言：</strong>
                    <p>{lastMessage}</p>
                  </div>
                )}

                 {activeFeature.id === "support" && (
                   <div className="ai-chat">
                     <div className="ai-messages">
                       {conversation.length === 0 ? (
                         <div className="ai-bubble bot">
                           歡迎使用 AI 問診示範介面，輸入訊息後可預覽未來模型的回覆流程。
                         </div>
                       ) : (
                         conversation.map((message, index) => (
                           <div
                             key={`${message.role}-${index}`}
                             className={`ai-bubble ${
                               message.role === "user" ? "user" : "bot"
                             }`}
                           >
                             {message.content}
                           </div>
                         ))
                       )}
                     </div>
                     <div className="ai-input">
                       <textarea
                         placeholder="描述症狀或提出問題..."
                         value={aiDraft}
                         onChange={(event) => setAiDraft(event.target.value)}
                       />
                       <button type="button" onClick={handleAiSend}>
                         送出
                       </button>
                     </div>
                   </div>
                 )}
              </div>
            </main>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>

