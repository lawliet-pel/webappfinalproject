<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Final Project Demo - æµ®å‹•è¦–çª—</title>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Noto Sans TC", Arial, sans-serif;
        background-color: #f7f4eb;
        color: #2f362f;
      }

      .app {
        display: flex;
        min-height: 100vh;
      }

      .sidebar {
        position: fixed;
        top: 20px;
        left: 45px;
        width: 280px;
        padding: 24px;
        border-radius: 24px;
        background: rgba(255, 255, 255, 0.92);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .sidebar h1 {
        margin: 0;
        font-size: 24px;
        letter-spacing: 2px;
        text-align: center;
      }

      .feature-list {
        display: grid;
        gap: 12px;
        max-height: 400px;
        overflow-y: auto;
        padding-right: 4px;
      }

      .feature-list::-webkit-scrollbar {
        width: 6px;
      }

      .feature-list::-webkit-scrollbar-track {
        background: transparent;
      }

      .feature-list::-webkit-scrollbar-thumb {
        background: #c2c2c2;
        border-radius: 3px;
      }

      .feature-list::-webkit-scrollbar-thumb:hover {
        background: #a0a0a0;
      }

      .feature-card {
        padding: 16px;
        border-radius: 16px;
        background: #d7f2ec;
        color: #1c5a4b;
        font-weight: bold;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        cursor: pointer;
        border: 2px solid transparent;
      }

      .feature-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }

      .feature-card.active {
        background: #8bd2c5;
        border-color: #2b8371;
        color: #103d33;
      }

      .chat-box {
        margin-top: 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .chat-box label {
        font-weight: bold;
      }

      .chat-box textarea {
        width: 100%;
        min-height: 80px;
        resize: vertical;
        padding: 10px;
        border-radius: 12px;
        border: 1px solid #c2c2c2;
        font-family: inherit;
        font-size: 14px;
      }

      .chat-box button {
        align-self: flex-end;
        padding: 10px 18px;
        border-radius: 999px;
        border: none;
        background: linear-gradient(135deg, #ff9364, #f9698d);
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        transition: opacity 0.2s ease;
      }

      .chat-box button:hover {
        opacity: 0.85;
      }

      .content {
        margin-left: 340px;
        margin-right: 80px;
        padding: 20px 40px 40px 40px;
        flex: 1;
        min-height: 100vh;
      }

      .content-card {
        width: 100%;
        min-height: calc(100vh - 80px);
        padding: 28px;
        border-radius: 24px;
        background: #ffffff;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
      }

      .content-card h2 {
        margin-top: 0;
        font-size: 28px;
      }

      .message-preview {
        margin-top: 20px;
        padding: 16px;
        border-radius: 16px;
        background: #fff7e0;
        border: 1px dashed #e7b86d;
      }

       .ai-chat {
         margin-top: 28px;
         display: flex;
         flex-direction: column;
         gap: 16px;
       }

       .ai-messages {
         max-height: calc(100vh - 400px);
         min-height: 400px;
         overflow-y: auto;
         padding: 20px;
         border-radius: 18px;
         background: #faf7f2;
         box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.04);
         display: flex;
         flex-direction: column;
         gap: 14px;
       }

       .ai-bubble {
         max-width: 75%;
         padding: 14px 16px;
         border-radius: 18px;
         line-height: 1.6;
         white-space: pre-wrap;
         word-break: break-word;
         box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
       }

       .ai-bubble.user {
         align-self: flex-end;
         background: linear-gradient(135deg, #71d2c0, #48b7ab);
         color: #08352e;
       }

       .ai-bubble.bot {
         align-self: flex-start;
         background: #ffffff;
         color: #2f362f;
       }

       .ai-input {
         display: flex;
         gap: 12px;
         align-items: center;
         padding: 14px;
         border-radius: 16px;
         background: #fff;
         box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
       }

       .ai-input textarea {
         flex: 1;
         border: none;
         resize: none;
         min-height: 60px;
         font-family: inherit;
         font-size: 15px;
         line-height: 1.6;
         background: transparent;
       }

       .ai-input textarea:focus {
         outline: none;
       }

       .ai-input button {
         padding: 12px 20px;
         border-radius: 12px;
         border: none;
         background: linear-gradient(135deg, #ff8b7d, #f965a7);
         color: #fff;
         font-weight: bold;
         cursor: pointer;
         transition: transform 0.2s ease, opacity 0.2s ease;
       }

       .ai-input button:hover {
         opacity: 0.9;
         transform: translateY(-1px);
       }

      /* æ¼¢å ¡é¸å–®æ¨£å¼ */
      .hamburger-menu {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }

      .hamburger-button {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.92);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        border: none;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 5px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .hamburger-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 16px 35px rgba(0, 0, 0, 0.15);
      }

      .hamburger-button span {
        width: 24px;
        height: 3px;
        background: #2f362f;
        border-radius: 2px;
        transition: all 0.3s ease;
      }

      .hamburger-button.active span:nth-child(1) {
        transform: rotate(45deg) translate(7px, 7px);
      }

      .hamburger-button.active span:nth-child(2) {
        opacity: 0;
      }

      .hamburger-button.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -7px);
      }

      .menu-dropdown {
        position: absolute;
        top: 60px;
        right: 0;
        min-width: 200px;
        padding: 12px 0;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.98);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
      }

      .menu-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .menu-item {
        padding: 14px 20px;
        color: #2f362f;
        cursor: pointer;
        transition: background-color 0.2s ease;
        font-weight: 500;
      }

      .menu-item:hover {
        background-color: #f0f0f0;
      }

      .menu-item:first-child {
        border-top-left-radius: 16px;
        border-top-right-radius: 16px;
      }

      .menu-item:last-child {
        border-bottom-left-radius: 16px;
        border-bottom-right-radius: 16px;
      }

      /* é ç´„ä»‹é¢æ¨£å¼ */
      .appointment-form {
        margin-top: 24px;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .form-group label {
        font-weight: bold;
        color: #2f362f;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        padding: 12px;
        border-radius: 12px;
        border: 1px solid #c2c2c2;
        font-family: inherit;
        font-size: 14px;
        transition: border-color 0.2s ease;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #8bd2c5;
      }

      .form-group textarea {
        resize: vertical;
        min-height: 100px;
      }

      .form-actions {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        margin-top: 8px;
      }

      .btn-primary {
        padding: 12px 24px;
        border-radius: 12px;
        border: none;
        background: linear-gradient(135deg, #71d2c0, #48b7ab);
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }

      .btn-primary:hover {
        opacity: 0.9;
        transform: translateY(-1px);
      }

      .btn-secondary {
        padding: 12px 24px;
        border-radius: 12px;
        border: 1px solid #c2c2c2;
        background: #fff;
        color: #2f362f;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }

      .btn-secondary:hover {
        background-color: #f5f5f5;
      }

      /* å¡«å¯«ç—‡ç‹€ä»‹é¢æ¨£å¼ */
      .symptom-form {
        margin-top: 24px;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .symptom-category {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .symptom-category h3 {
        margin: 0;
        font-size: 18px;
        color: #2f362f;
        border-bottom: 2px solid #8bd2c5;
        padding-bottom: 8px;
      }

      .checkbox-group {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 16px;
        border-radius: 12px;
        border: 2px solid #d7f2ec;
        background: #f9f9f9;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .checkbox-item:hover {
        border-color: #8bd2c5;
        background: #f0f9f7;
      }

      .checkbox-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }

      .checkbox-item.checked {
        border-color: #48b7ab;
        background: #e8f5f3;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const featureConfigs = [
        {
          id: "service",
          title: "æœå‹™ä»‹ç´¹",
          description:
            "è—‰ç”±AIè¼”åŠ©å•è¨ºé™ä½é†«ç™‚äººåŠ›çš„è² æ“”ï¼Œæå‡é†«ç™‚æ•ˆç‡ã€‚",
        },
        {
          id: "schedule",
          title: "é ç´„",
          description:
            "æä¾›é ç´„æœå‹™ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å¿«é€Ÿé ç´„æœå‹™ã€‚",
        },
        {
          id: "symptom",
          title: "å¡«å¯«ç—‡ç‹€",
          description:
            "å¡«å¯«æ‚¨çš„ç—‡ç‹€è³‡è¨Šï¼Œå”åŠ©é†«å¸«æ›´æº–ç¢ºåœ°é€²è¡Œè¨ºæ–·ã€‚",
        },
        {
          id: "support",
          title: "AIå•è¨º",
          description:
            "æä¾›AIå•è¨ºæœå‹™ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å¿«é€Ÿå•è¨ºã€‚",
        },
      ];

      function App() {
        const [activeFeature, setActiveFeature] = useState(featureConfigs[0]);
        const [draftMessage, setDraftMessage] = useState("");
        const [lastMessage, setLastMessage] = useState("");
         const [conversation, setConversation] = useState([]);
         const [aiDraft, setAiDraft] = useState("");
         const [menuOpen, setMenuOpen] = useState(false);
         const menuRef = useRef(null);
         const [currentUser, setCurrentUser] = useState(null); // ç”¨ä¾†å­˜ä½¿ç”¨è€…è³‡æ–™
         //AIåˆ¤æ–·ç–¾ç—…
         const [predictedDisease, setPredictedDisease] = useState("");
         // é ç´„è¡¨å–®ç‹€æ…‹
         const [appointmentForm, setAppointmentForm] = useState({
           date: "",
           time: "",
           doctor: "",
           department: "",
           reason: "",
         });
         // ç—‡ç‹€è¡¨å–®ç‹€æ…‹
         const [symptomForm, setSymptomForm] = useState({
           description: "",
           duration: "",
           severity: "",
           symptoms: [],
           additionalNotes: "",
         });

        // åœ¨å·¦å´æµ®å‹•è¦–çª—å…§æ›´æ–°é¸æ“‡ç‹€æ…‹èˆ‡è¼¸å…¥è¨Šæ¯
        const selectFeature = (feature) => {
          setActiveFeature(feature);
        };

        // è™•ç†èŠå¤©è¼¸å…¥çš„æäº¤ä¸¦é¡¯ç¤ºæ–¼å³å´å€å¡Š
        const handleSend = () => {
          if (!draftMessage.trim()) {
            return;
          }
          setLastMessage(draftMessage.trim());
          setDraftMessage("");
        };

         // è™•ç† AI å•è¨ºå³å´å°è©±æ¡†çš„è¨Šæ¯æäº¤ï¼Œé è¨­å›è¦†å¯æ›¿æ›ç‚ºæœªä¾†ä¸²æ¥çš„ LLM çµæœ
      const handleAiSend = async () => {
        if (!aiDraft.trim()) {
          return;
        }

        const input = aiDraft.trim();
        
        //å»ºç«‹ç•¶å‰ä½¿ç”¨è€…ç‰©ä»¶
        const userMessage = { role: "user", content: input };

        //ä½¿ç”¨è€…çš„è©±é¡¯ç¤ºåœ¨ç•«é¢ä¸Š
        setConversation((prev) => [...prev, userMessage]);
        setAiDraft("");

        try {
          const GOOGLE_API_KEY = "AIzaSyCkGFAgJSYtELBMe7m5VlXVMBlI9ZOG620"; 
          const API_ENDPOINT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GOOGLE_API_KEY}`;

          //System Prompt
          const systemPrompt = `
ä½ ç¾åœ¨æ˜¯ä¸€å€‹é†«ç™‚å•è¨ºå°ˆæ¡ˆçš„ AI åŠ©æ‰‹ã€‚
è«‹æ ¹æ“šä½¿ç”¨è€…çš„ç—‡ç‹€æè¿°èˆ‡å°è©±æ­·å²ï¼ŒåŸ·è¡Œä»¥ä¸‹ä»»å‹™ï¼š

1. ã€åˆ¤æ–·ç–¾ç—…ã€‘ï¼šæ¨æ¸¬å¯èƒ½çš„ç–¾ç—…åç¨±ï¼ˆè‹¥è³‡è¨Šä¸è¶³å¯å¯«ã€Œå¾…è§€å¯Ÿã€ï¼‰ã€‚
2. ã€çµ¦äºˆå»ºè­°ã€‘ï¼šæä¾›ç°¡çŸ­çš„è­·ç†å»ºè­°æˆ–å°±é†«æŒ‡å¼•ï¼Œå¦‚æœä½ é‚„æœªæˆåŠŸåˆ¤æ–·å‡ºç–¾ç—…ï¼Œè«‹ä¸è¦çµ¦äºˆå»ºè­°ï¼Œå•ä½¿ç”¨è€…å…¶ä»–å•é¡Œä»¥é”åˆ°åˆ¤æ–·ç—…å› çš„ç›®çš„ã€‚

âš ï¸ é‡è¦å›è¦†æ ¼å¼è¦å®šï¼š
è«‹å‹™å¿…ä½¿ç”¨ "###SEGMENT###" ç¬¦è™Ÿå°‡ç–¾ç—…åç¨±èˆ‡å»ºè­°åˆ†é–‹ã€‚
æ ¼å¼å¦‚ä¸‹ï¼š
[ç–¾ç—…åç¨±]###SEGMENT###[çµ¦ä½¿ç”¨è€…çš„è¦ªåˆ‡å»ºè­°]

ç¯„ä¾‹ï¼š
æ„Ÿå†’###SEGMENT###å»ºè­°å¤šå–æº«é–‹æ°´ï¼Œä¸¦å¤šä¼‘æ¯ã€‚

ä½¿ç”¨è€…ç›®å‰çš„è¼¸å…¥ï¼š
`;

          //æ­·å²å°è©±ç´€éŒ„æˆprompt
          const historyContents = conversation.map((msg) => ({
            role: msg.role === "user" ? "user" : "model", // Gemini ç¨± AI ç‚º 'model'
            parts: [{ text: msg.content }],
          }));

          //çµ„åˆæœ€çµ‚çš„ requestBody
          const requestBody = {
            contents: [
              ...historyContents, 
              {
                role: "user",
                parts: [
                  {
                    text: systemPrompt + input 
                  }
                ]
              }
            ]
          };

          const response = await fetch(API_ENDPOINT, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody) 
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`API è«‹æ±‚å¤±æ•—: ${response.statusText} (${response.status}) - ${errorData.error.message}`);
          }

          const data = await response.json();
          
          if (!data.candidates || data.candidates.length === 0) {
              throw new Error("API å›è¦†ä¸­æ²’æœ‰æ‰¾åˆ° 'candidates'");
          }
          
          // å–å¾—å®Œæ•´å›è¦†æ–‡å­—
          const fullText = data.candidates[0]?.content?.parts[0]?.text || "";

          //å°‡ç–¾ç—…èˆ‡å»ºè­°åˆ†é–‹
          const parts = fullText.split("###SEGMENT###");
          
          let diseasePart = "åˆ¤æ–·ä¸­...";
          let advicePart = fullText; 

          if (parts.length === 2) {
            diseasePart = parts[0].trim();
            advicePart = parts[1].trim();
          }

          console.log("AI è¨ºæ–·ç–¾ç—…:", diseasePart);
          setPredictedDisease(diseasePart);

          const botMessage = {
            role: "assistant",
            content: advicePart,
          };
          
          setConversation((prev) => [...prev, botMessage]);

        } catch (error) {
          console.error("API å‘¼å«å¤±æ•—:", error);
          const errorMessage = {
            role: "assistant",
            content: `æŠ±æ­‰ï¼Œç™¼ç”ŸéŒ¯èª¤ï¼š${error.message}`
          };
          setConversation((prev) => [...prev, errorMessage]);
        }
      };

         // è™•ç†æ¼¢å ¡é¸å–®é–‹é—œ
         const toggleMenu = () => {
           setMenuOpen(!menuOpen);
         };

        // è™•ç†ç™»å…¥ (æ¨¡æ“¬)
        const handleLogin = () => {
          // ä½¿ç”¨ç€è¦½å™¨å…§å»ºçš„è¼¸å…¥æ¡†ï¼Œæ¨¡æ“¬è¼¸å…¥å¸³è™Ÿ
          const name = window.prompt("è«‹è¼¸å…¥æ‚¨çš„å§“åä»¥ç™»å…¥ï¼š", "ä½¿ç”¨è€…");
          
          if (name) {
            // å¦‚æœæœ‰è¼¸å…¥åå­—ï¼Œå°±è¨­å®šç‚ºç™»å…¥ç‹€æ…‹
            setCurrentUser({ name: name, id: Date.now() });
            setMenuOpen(false); // é—œé–‰é¸å–®
            alert(`æ­¡è¿å›ä¾†ï¼Œ${name}ï¼`);
          }
        };

        // è™•ç†ç™»å‡º
        const handleLogout = () => {
          if (window.confirm("ç¢ºå®šè¦ç™»å‡ºç³»çµ±å—ï¼Ÿ")) {
            setCurrentUser(null); // æ¸…é™¤ä½¿ç”¨è€…ç‹€æ…‹
            setMenuOpen(false);
          }
        };

         // é»æ“Šå¤–éƒ¨é—œé–‰é¸å–®
         useEffect(() => {
           const handleClickOutside = (event) => {
             if (menuRef.current && !menuRef.current.contains(event.target)) {
               setMenuOpen(false);
             }
           };

           if (menuOpen) {
             document.addEventListener("mousedown", handleClickOutside);
           }

           return () => {
             document.removeEventListener("mousedown", handleClickOutside);
           };
         }, [menuOpen]);

         // è™•ç†é ç´„è¡¨å–®æäº¤
         const handleAppointmentSubmit = (e) => {
           e.preventDefault();
           alert("é ç´„æˆåŠŸï¼é ç´„è³‡è¨Šå·²é€å‡ºã€‚");
           setAppointmentForm({
             date: "",
             time: "",
             doctor: "",
             department: "",
             reason: "",
           });
         };

         // è™•ç†ç—‡ç‹€è¡¨å–®æäº¤
         const handleSymptomSubmit = (e) => {
           e.preventDefault();
           alert("ç—‡ç‹€è³‡è¨Šå·²æäº¤ï¼");
           setSymptomForm({
             description: "",
             duration: "",
             severity: "",
             symptoms: [],
             additionalNotes: "",
           });
         };

         // è™•ç†ç—‡ç‹€é¸é …åˆ‡æ›
         const toggleSymptom = (symptom) => {
           setSymptomForm((prev) => {
             const symptoms = prev.symptoms.includes(symptom)
               ? prev.symptoms.filter((s) => s !== symptom)
               : [...prev.symptoms, symptom];
             return { ...prev, symptoms };
           });
         };

         // å¸¸è¦‹ç—‡ç‹€é¸é …
         const commonSymptoms = [
           "ç™¼ç‡’",
           "å’³å—½",
           "é ­ç—›",
           "å–‰åš¨ç—›",
           "æµé¼»æ°´",
           "è‚Œè‚‰ç— ç—›",
           "ç–²å‹",
           "å™å¿ƒ",
           "è…¹ç€‰",
           "å‘¼å¸å›°é›£",
           "èƒ¸ç—›",
           "é ­æšˆ",
         ];

        return (
          <div className="app">
            <aside className="sidebar">
              <h1>åŠŸèƒ½è¡¨</h1>
              <div className="feature-list">
                {featureConfigs.map((feature) => (
                  <div
                    key={feature.id}
                    className={`feature-card ${
                      activeFeature.id === feature.id ? "active" : ""
                    }`}
                    onClick={() => selectFeature(feature)}
                  >
                    {feature.title}
                  </div>
                ))}
              </div>

              <div className="chat-box">
                <label htmlFor="chat-input">å¿«é€Ÿè¨Šæ¯</label>
                <textarea
                  id="chat-input"
                  placeholder="è¼¸å…¥æƒ³è©¢å•çš„å…§å®¹..."
                  value={draftMessage}
                  onChange={(event) => setDraftMessage(event.target.value)}
                />
                <button type="button" onClick={handleSend}>
                  é€å‡ºè¨Šæ¯
                </button>
              </div>
            </aside>

            {/* æ¼¢å ¡é¸å–® */}
            <div className="hamburger-menu" ref={menuRef}>
              <button
                className={`hamburger-button ${menuOpen ? "active" : ""}`}
                onClick={toggleMenu}
                aria-label="é¸å–®"
              >
                <span></span>
                <span></span>
                <span></span>
              </button>
              <div className={`menu-dropdown ${menuOpen ? "active" : ""}`}>
                
                {currentUser ? (
                  /* æƒ…æ³ Aï¼šå¦‚æœæœ‰ç™»å…¥ï¼Œé¡¯ç¤ºåå­—å’Œç™»å‡ºæŒ‰éˆ• */
                  <>
                    <div className="menu-item" style={{cursor: 'default', color: '#2b8371', fontWeight: 'bold'}}>
                      ğŸ‘¤ {currentUser.name}
                    </div>
                    <div className="menu-item" onClick={handleLogout}>
                      ç™»å‡º
                    </div>
                  </>
                ) : (
                  /* æƒ…æ³ Bï¼šå¦‚æœæ²’ç™»å…¥ï¼Œé¡¯ç¤ºç™»å…¥æŒ‰éˆ• */
                  <div className="menu-item" onClick={handleLogin}>
                    ç™»å…¥
                  </div>
                )}

              </div>
            </div>

            <main className="content">
              <div className="content-card">
                <h2>{activeFeature.title}</h2>
                <p>{activeFeature.description}</p>

                {/* æœå‹™ä»‹ç´¹ */}
                {activeFeature.id === "service" && lastMessage && (
                  <div className="message-preview">
                    <strong>æœ€æ–°ç•™è¨€ï¼š</strong>
                    <p>{lastMessage}</p>
                  </div>
                )}

                {/* é ç´„ä»‹é¢ */}
                {activeFeature.id === "schedule" && (
                  <form className="appointment-form" onSubmit={handleAppointmentSubmit}>
                    <div className="form-group">
                      <label htmlFor="appointment-date">é¸æ“‡æ—¥æœŸ</label>
                      <input
                        type="date"
                        id="appointment-date"
                        value={appointmentForm.date}
                        onChange={(e) =>
                          setAppointmentForm({ ...appointmentForm, date: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label htmlFor="appointment-time">é¸æ“‡æ™‚é–“</label>
                      <select
                        id="appointment-time"
                        value={appointmentForm.time}
                        onChange={(e) =>
                          setAppointmentForm({ ...appointmentForm, time: e.target.value })
                        }
                        required
                      >
                        <option value="">è«‹é¸æ“‡æ™‚é–“</option>
                        <option value="09:00">09:00</option>
                        <option value="10:00">10:00</option>
                        <option value="11:00">11:00</option>
                        <option value="14:00">14:00</option>
                        <option value="15:00">15:00</option>
                        <option value="16:00">16:00</option>
                        <option value="17:00">17:00</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label htmlFor="appointment-department">é¸æ“‡ç§‘åˆ¥</label>
                      <select
                        id="appointment-department"
                        value={appointmentForm.department}
                        onChange={(e) =>
                          setAppointmentForm({ ...appointmentForm, department: e.target.value })
                        }
                        required
                      >
                        <option value="">è«‹é¸æ“‡ç§‘åˆ¥</option>
                        <option value="å…§ç§‘">å…§ç§‘</option>
                        <option value="å¤–ç§‘">å¤–ç§‘</option>
                        <option value="å°å…’ç§‘">å°å…’ç§‘</option>
                        <option value="å©¦ç”¢ç§‘">å©¦ç”¢ç§‘</option>
                        <option value="çš®è†šç§‘">çš®è†šç§‘</option>
                        <option value="è€³é¼»å–‰ç§‘">è€³é¼»å–‰ç§‘</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label htmlFor="appointment-doctor">é¸æ“‡é†«å¸«</label>
                      <select
                        id="appointment-doctor"
                        value={appointmentForm.doctor}
                        onChange={(e) =>
                          setAppointmentForm({ ...appointmentForm, doctor: e.target.value })
                        }
                        required
                      >
                        <option value="">è«‹é¸æ“‡é†«å¸«</option>
                        <option value="ç‹é†«å¸«">ç‹é†«å¸«</option>
                        <option value="æé†«å¸«">æé†«å¸«</option>
                        <option value="å¼µé†«å¸«">å¼µé†«å¸«</option>
                        <option value="é™³é†«å¸«">é™³é†«å¸«</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label htmlFor="appointment-reason">é ç´„åŸå› </label>
                      <textarea
                        id="appointment-reason"
                        placeholder="è«‹ç°¡è¿°æ‚¨çš„é ç´„åŸå› ..."
                        value={appointmentForm.reason}
                        onChange={(e) =>
                          setAppointmentForm({ ...appointmentForm, reason: e.target.value })
                        }
                      />
                    </div>
                    <div className="form-actions">
                      <button type="button" className="btn-secondary" onClick={() => setAppointmentForm({
                        date: "",
                        time: "",
                        doctor: "",
                        department: "",
                        reason: "",
                      })}>
                        æ¸…é™¤
                      </button>
                      <button type="submit" className="btn-primary">
                        ç¢ºèªé ç´„
                      </button>
                    </div>
                  </form>
                )}

                {/* å¡«å¯«ç—‡ç‹€ä»‹é¢ */}
                {activeFeature.id === "symptom" && (
                  <form className="symptom-form" onSubmit={handleSymptomSubmit}>
                    <div className="form-group">
                      <label htmlFor="symptom-description">ä¸»è¦ç—‡ç‹€æè¿°</label>
                      <textarea
                        id="symptom-description"
                        placeholder="è«‹è©³ç´°æè¿°æ‚¨çš„ä¸»è¦ç—‡ç‹€..."
                        value={symptomForm.description}
                        onChange={(e) =>
                          setSymptomForm({ ...symptomForm, description: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="symptom-category">
                      <h3>å¸¸è¦‹ç—‡ç‹€ï¼ˆå¯è¤‡é¸ï¼‰</h3>
                      <div className="checkbox-group">
                        {commonSymptoms.map((symptom) => (
                          <div
                            key={symptom}
                            className={`checkbox-item ${
                              symptomForm.symptoms.includes(symptom) ? "checked" : ""
                            }`}
                            onClick={() => toggleSymptom(symptom)}
                          >
                            <input
                              type="checkbox"
                              checked={symptomForm.symptoms.includes(symptom)}
                              onChange={() => toggleSymptom(symptom)}
                            />
                            <label>{symptom}</label>
                          </div>
                        ))}
                      </div>
                    </div>
                    <div className="form-group">
                      <label htmlFor="symptom-duration">ç—‡ç‹€æŒçºŒæ™‚é–“</label>
                      <select
                        id="symptom-duration"
                        value={symptomForm.duration}
                        onChange={(e) =>
                          setSymptomForm({ ...symptomForm, duration: e.target.value })
                        }
                        required
                      >
                        <option value="">è«‹é¸æ“‡æŒçºŒæ™‚é–“</option>
                        <option value="1å¤©ä»¥å…§">1å¤©ä»¥å…§</option>
                        <option value="2-3å¤©">2-3å¤©</option>
                        <option value="4-7å¤©">4-7å¤©</option>
                        <option value="1-2é€±">1-2é€±</option>
                        <option value="2é€±ä»¥ä¸Š">2é€±ä»¥ä¸Š</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label htmlFor="symptom-severity">åš´é‡ç¨‹åº¦</label>
                      <select
                        id="symptom-severity"
                        value={symptomForm.severity}
                        onChange={(e) =>
                          setSymptomForm({ ...symptomForm, severity: e.target.value })
                        }
                        required
                      >
                        <option value="">è«‹é¸æ“‡åš´é‡ç¨‹åº¦</option>
                        <option value="è¼•å¾®">è¼•å¾®</option>
                        <option value="ä¸­ç­‰">ä¸­ç­‰</option>
                        <option value="åš´é‡">åš´é‡</option>
                        <option value="éå¸¸åš´é‡">éå¸¸åš´é‡</option>
                      </select>
                    </div>
                    <div className="form-group">
                      <label htmlFor="symptom-notes">å…¶ä»–è£œå……èªªæ˜</label>
                      <textarea
                        id="symptom-notes"
                        placeholder="å¦‚æœ‰å…¶ä»–ç›¸é—œè³‡è¨Šï¼Œè«‹åœ¨æ­¤è£œå……..."
                        value={symptomForm.additionalNotes}
                        onChange={(e) =>
                          setSymptomForm({ ...symptomForm, additionalNotes: e.target.value })
                        }
                      />
                    </div>
                    <div className="form-actions">
                      <button type="button" className="btn-secondary" onClick={() => setSymptomForm({
                        description: "",
                        duration: "",
                        severity: "",
                        symptoms: [],
                        additionalNotes: "",
                      })}>
                        æ¸…é™¤
                      </button>
                      <button type="submit" className="btn-primary">
                        æäº¤ç—‡ç‹€è³‡è¨Š
                      </button>
                    </div>
                  </form>
                )}

                 {activeFeature.id === "support" && (
                   <div className="ai-chat">
                     <div className="ai-messages">
                       {conversation.length === 0 ? (
                         <div className="ai-bubble bot">
                           æ­¡è¿ä½¿ç”¨ AI å•è¨ºç¤ºç¯„ä»‹é¢ï¼Œè¼¸å…¥è¨Šæ¯å¾Œå¯é è¦½æœªä¾†æ¨¡å‹çš„å›è¦†æµç¨‹ã€‚
                         </div>
                       ) : (
                         conversation.map((message, index) => (
                           <div
                             key={`${message.role}-${index}`}
                             className={`ai-bubble ${
                               message.role === "user" ? "user" : "bot"
                             }`}
                           >
                             {message.content}
                           </div>
                         ))
                       )}
                     </div>
                     <div className="ai-input">
                       <textarea
                         placeholder="æè¿°ç—‡ç‹€æˆ–æå‡ºå•é¡Œ..."
                         value={aiDraft}
                         onChange={(event) => setAiDraft(event.target.value)}
                       />
                       <button type="button" onClick={handleAiSend}>
                         é€å‡º
                       </button>
                     </div>
                   </div>
                 )}
              </div>
            </main>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
